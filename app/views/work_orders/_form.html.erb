<%= form_for @o_single, :html => { :class => 'form-horizontal' } do |f| %>
  <fieldset>
    <legend></legend>

    
<div class="control-group">
  <%= f.label :area_id, :class => 'control-label' %>
  <div class="controls">
    <%= select_tag "work_order[area_id]", options_for_select(get_area_data, (@o_single.area.id unless @o_single.area.nil?)),
    							:data => { :remote => true, :url => url_for(:controller => "fronts", 
                             :action => "get_section_row_plot_grave_from_area",
                             :class => 'selectField'
                             ) } %>
  </div>
</div>

<div id="div_update_section_row_plot_grave">
	
 	<div class="control-group">
    <%= f.label :section_id, :class => 'control-label' %>
    <div class="controls">
      <%= select_tag "work_order[section_id]", options_for_select(get_section_data(@o_single), (@o_single.section.id unless @o_single.section.nil?)),
      							:data => { :remote => true, :url => url_for(:controller => "fronts", 
                               :action => "get_row_plot_grave_from_section",
                                 	 :class => 'selectField'
                               ) } %>
    </div>                           
 	</div>	      

	<div id="div_update_row_plot_grave">
		
   	<div class="control-group">
      <%= f.label :row_id, :class => 'control-label' %>
      <div class="controls">
        <%= select_tag "work_order[row_id]", options_for_select(get_row_data(@o_single), (@o_single.row.id unless @o_single.row.nil?)), 
      							:data => { :remote => true, :url => url_for(:controller => "fronts", 
                               :action => "get_plot_grave_from_row",
                                 	 :class => 'selectField'
                               ) } %>
      </div>
    </div>
  	
  	<div id="div_update_plot_grave">
  		
	   	<div class="control-group">
	      <%= f.label :plot_id, :class => 'control-label' %>
	      <div class="controls">
	        <%= select_tag "work_order[plot_id]", options_for_select(get_plot_data(@o_single), (@o_single.plot.id unless @o_single.plot.nil?)), 
        							:data => { :remote => true, :url => url_for(:controller => "fronts", 
                                 :action => "get_grave_from_plot",
                                 	 :class => 'selectField'
                                 ) } %>
	      </div>
	    </div>
	  	
	  	<div id="div_update_grave">
		   	<div class="control-group">
		      <label class="control-label"><%= "Grave" %></label>
		      <div class="controls">
		        <%= f.select :grafe_id, options_for_select(get_grave_data(@o_single), (@o_single.grafe.id unless @o_single.grafe.nil?)) %>
		      </div>
		    </div>
		  </div>  	    
    
  	</div>
	</div>      		
</div>    
<table>
    <tr>
      <td valign="center" align="center" colspan="2">
		    <h4><%= t("general.customer_details") %></h4>
		  </td> 
    </tr>	 
    <tr>
      <td>&nbsp;</td> 
    </tr>	       
    <tr>
      <td>	
				<%= f.hidden_field :cemetery_id, :value => session[:cemetery_id] %>
				<div class="control-group"><%= f.label :title, :class => 'control-label' %><div class="controls"><%= f.text_field :title, :class => 'text_field' %></div></div>
      </td>
      <td>				
		    <div class="control-group">
		      <%= f.label :first_name, :class => 'control-label' %><span class="redStart">*</span>
		      <div class="controls">
		        <%= f.text_field :first_name, :class => 'text_field' %>
		       	<% if @o_single.errors[:first_name].any? %>
		        	<span class="text-error text-message"><%= @o_single.errors[:first_name].first %></span>
		      	<% end %> 
		      </div>
		    </div>
      </td> 
    </tr> 
    <tr>
      <td>		    		 
		    <div class="control-group">
		      <%= f.label :surname, :class => 'control-label' %><span class="redStart">*</span>
		      <div class="controls">
		        <%= f.text_field :surname, :class => 'text_field' %>
		       	<% if @o_single.errors[:surname].any? %>
		        	<span class="text-error text-message"><%= @o_single.errors[:surname].first %></span>
		      	<% end %> 
		      </div>
		    </div>
      </td>
      <td>		    
		 		<div class="control-group"><%= f.label :middle_name, :class => 'control-label' %><div class="controls"><%= f.text_field :middle_name, :class => 'text_field' %></div></div>
      </td> 
    </tr> 
    <tr>
      <td>			 	
		    <div class="control-group"><%= f.label :address, :class => 'control-label' %><div class="controls"><%= f.text_field :address, :class => 'text_field' %></div></div>
      </td> 
    </tr> 
    <tr>
      <td>		    
		    <div class="control-group"><%= f.label :town, :class => 'control-label' %><div class="controls"><%= f.text_field :town, :class => 'text_field' %></div></div>
      </td>
      <td>		    
		    <div class="control-group"><%= f.label :state, :class => 'control-label' %><div class="controls"><%= f.text_field :state, :class => 'text_field' %></div></div>
      </td> 
    </tr> 
    <tr>
      <td>		    
		    <div class="control-group"><%= f.label :postal_code, :class => 'control-label' %><div class="controls"><%= f.text_field :postal_code, :class => 'text_field' %></div></div>
      </td>
      <td>		    
		    <div class="control-group"><%= f.label :phone_area_code, :class => 'control-label' %><div class="controls"><%= f.text_field :phone_area_code, :class => 'text_field' %></div></div>
      </td> 
    </tr> 
    <tr>
      <td>		    
		    <div class="control-group"><%= f.label :phone, :class => 'control-label' %><div class="controls"><%= f.text_field :phone, :class => 'text_field' %></div></div>
      </td>
      <td>		    
		    <div class="control-group"><%= f.label :fax_area_code, :class => 'control-label' %><div class="controls"><%= f.text_field :fax_area_code, :class => 'text_field' %></div></div>
      </td> 
    </tr> 
    <tr>
      <td>		    
		    <div class="control-group"><%= f.label :fax, :class => 'control-label' %><div class="controls"><%= f.text_field :fax, :class => 'text_field' %></div></div>
		  </td>
      <td>
		    <div class="control-group"><%= f.label :email, :class => 'control-label' %><div class="controls"><%= f.text_field :email, :class => 'text_field' %></div></div>
      </td> 
    </tr> 

    <tr>
      <td valign="center" align="center" colspan="2">		    
		    <h4><%= t("general.work_order") %></h4>
		  </td> 
    </tr>	  

    <tr>
      <td>		    
			 	<div class="control-group">
			    <%= f.label :delegation_department_id, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.select :delegation_department_id, options_for_select(get_delegation_department_data, (@o_single.delegation_department.id unless @o_single.delegation_department.nil?)) %>
			    </div>
			  </div>
		  </td>
		  <td>
				<div class="control-group"><%= f.label :description, :class => 'control-label' %><div class="controls"><%= f.text_area :description, :class => 'text_field' %></div></div>		  	
		  </td> 
    </tr>	 
     <tr>
      <td>		    
			 	<div class="control-group">
			    <%= f.label :work_type_id, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.select :work_type_id, options_for_select(get_work_type_data, (@o_single.work_type.id unless @o_single.work_type.nil?)) %>
			    </div>
			  </div>
		  </td>
		</tr>     
    <tr>
      <td>	 	
		    <div class="control-group">
		      <%= f.label :work_date, :class => 'control-label' %>
		      <div class="controls">
			 			<div id="work_date" class="input-append">
			 				<%= f.text_field :work_date, :class => 'text_field' %>
					    <span class="add-on">
					      <i data-time-icon="icon-time" data-date-icon="icon-calendar">
					      </i>
					    </span> 				
			 			</div>	
		      </div>
		    </div>
      </td>
      
      <td>	 	
		    <div class="control-group">
		      <%= f.label :completion_date, :class => 'control-label' %>
		      <div class="controls">
			 			<div id="completion_date" class="input-append">
			 				<%= f.text_field :completion_date, :class => 'text_field' %>
					    <span class="add-on">
					      <i data-time-icon="icon-time" data-date-icon="icon-calendar">
					      </i>
					    </span> 				
			 			</div>	
		      </div>
		    </div>
      </td>       
    </tr>    

    <tr>
      <td>		    
			 	<div class="control-group">
			    <%= f.label :completed_by, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.select :completed_user_id, options_for_select(get_normal_staff, (@o_single.completed_by.id unless @o_single.completed_by.nil?)) %>
			    </div>
			  </div
		  </td>
		  <td>
			 	<div class="control-group">
			    <%= f.label :catalog_id, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.select :catalog_id, options_for_select(get_catalog_data, (@o_single.catalog.id unless @o_single.catalog.nil?)) %>
			    </div>
			  </div>
		  </td> 
    </tr>


    <tr>
      <td>		    
		    <div class="control-group"><%= f.label :receipt_number, :class => 'control-label' %><div class="controls"><%= f.text_field :receipt_number, :class => 'text_field' %></div></div>
      </td>    	
    	<td>
		    <div class="control-group">
		      <%= f.label :is_completed, :class => 'control-label' %>
		      <div class="controls">
		        <%= f.check_box :is_completed, :class => 'check_box' %>
		      </div>
		    </div>     		
    	</td>
    </tr>
</table>     
 
    <div class="form-actions">
      <%= f.submit nil, :class => 'btn btn-primary' %>
      <%= link_to 'Cancel', work_orders_url, :class => 'btn' %>
    </div>
    
  </fieldset>
     
<% end %>
<script>
$(function() {
//https://github.com/lubieniebieski/bootstrap-datetimepicker-rails	
  $('#work_date').datetimepicker({
    language: 'en',
    pickTime: false,
    format: "yyyy-MM-dd"
  });
  $('#completion_date').datetimepicker({
    language: 'en',
    pickTime: false,
    format: "yyyy-MM-dd"
  });	  	
});  
</script>